<!-- Final CSS for the "Today-First" Agenda View -->
<style>
    .timetable-page-wrapper {
        background-color: #f4f6f9;
        min-height: 100vh;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    /* The top bar for switching days */
    .day-switcher {
        display: flex;
        justify-content: space-around;
        padding: 10px 5px;
        background-color: #ffffff;
        border-bottom: 1px solid #e5e7eb;
        position: sticky;
        top: 60px;
        z-index: 100;
    }

    .day-switcher-item {
        padding: 8px 12px;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.9rem;
        color: #6c757d;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
    }

    .day-switcher-item.active {
        background-color: #007bff;
        color: #ffffff;
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.4);
    }

    /* Container for the daily schedule, enables swiping */
    .agenda-view-container {
        padding: 20px 15px;
    }

    .schedule-list-item {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
    }

    /* The vertical timeline on the left */
    .timeline-track {
        width: 60px;
        text-align: center;
        flex-shrink: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        font-size: 0.75rem;
        color: #6c757d;
        font-weight: 500;
    }

    .timeline-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: #d1d5db;
        margin: 5px 0;
    }

    .timeline-line {
        width: 2px;
        height: 50px;
        /* Adjust as needed */
        background-color: #e5e7eb;
    }

    /* The card for the period */
    .period-card {
        flex-grow: 1;
        border-radius: 12px;
        padding: 15px;
        min-height: 80px;
        transition: all 0.2s ease;
        border: 2px solid transparent;
    }

    .subject-card {
        color: #fff;
    }

    .subject-name {
        font-size: 1.1rem;
        font-weight: 600;
    }

    .teacher-name {
        font-size: 0.85rem;
        opacity: 0.9;
        margin-top: 4px;
        text-transform: uppercase;
    }

    .free-card {
        background-color: #ffffff;
        border: 2px dashed #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #b5b5c3;
        font-style: italic;
    }

    /* === Highlighting States === */
    /* .is-past { opacity: 0.6; } */
    .is-past .timeline-dot {
        background-color: #d1d5db;
    }

    .is-current .period-card {
        transform: scale(1.02);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border-color: #ffc107;
        /* A gold/yellow border to signify "current" */
    }

    .is-current .timeline-dot {
        background-color: #007bff;
    }
</style>
<div class="app-page flex-column flex-column-fluid">

    <ng-include src="'partials/Templates/header.html'" class="app-header d-flex"></ng-include>
    <div class="timetable-page-wrapper">
        <!-- Your existing header if you have one -->
        <!-- <ng-include src="'partials/Templates/header.html'"></ng-include> -->

        <!-- Day Switcher UI -->
        <div class="day-switcher">
            <div ng-repeat="day in WeekDays track by $index" class="day-switcher-item"
                ng-class="{'active': $index === currentDayIndex}" ng-click="selectDay($index)">
                {{ day.Value | limitTo:3 }}
            </div>
        </div>

        <!-- Agenda View: The swipeable container -->
        <div class="agenda-view-container" ng-swipe-left="nextDay()" ng-swipe-right="prevDay()">

            <div ng-if="!TimeTableMapping.length && !ShowLoader" class="text-center text-muted fs-4 py-10">
                No timetable data available for this student.
            </div>

            <!-- Loop through time slots for the currently selected day -->
            <div ng-repeat="clsTime in ClassTime track by $index" class="schedule-list-item"
                ng-class="getPeriodStatus(clsTime, currentDayIndex)"
                 ng-attr-id="{{ getPeriodStatus(clsTime, currentDayIndex) === 'is-current' ? 'current-period' : undefined }}">

                <!-- The timeline track on the left -->
                <div class="timeline-track fs-6">
                    <span>{{ formatTime(clsTime.Value.split('-')[0].trim()) }}</span> <!-- Start Time -->
                    <div class="timeline-dot"></div>
                    <div class="timeline-line"></div>
                    <span>{{formatTime(clsTime.Value.split('-')[1].trim()) }}</span> <!-- End Time -->
                </div>

                <!-- The Period Card on the right -->
                <div ng-if="slot = processedTimetable[currentDayObject.Key][clsTime.Key]" class="flex-grow-1 ms-2">
                    <div class="period-card subject-card card"
                        ng-style="{'background-color': getSubjectColor(slot.Subject.Value)}">
                        <span class="subject-name me-2 fs-4 mb-2">{{ slot.Subject.Value }}</span>
                        <div class="teacher-name  fs-5 d-flex mb-1" ng-if="slot.StaffNames">
                            <div class="symbol symbol-20px bg-light-pearl symbol-circle me-3">
                                <span class="symbol-label  bg-white">
                                    <img src="./images/profile/profile.svg" class="" alt="">
                                </span>
                            </div>
                            {{ slot.StaffNames }}
                        </div>
                        <div class="teacher-name  fs-5 d-flex" ng-if="slot.StaffNames">
                            <div class="symbol symbol-20px bg-light-pearl symbol-circle me-3">
                                <span class="symbol-label  bg-light-pearl">
                                    <img src="./images/profile/clock.png" class="w-100" alt="">
                                </span>
                            </div>
                              {{ formatTime(clsTime.Value) }}
                        </div>
                    </div>
                </div>

                <!-- Or a Free card if no slot -->
                <div ng-if="!processedTimetable[currentDayObject.Key][clsTime.Key]" style="width:100%">
                    <div class="period-card free-card">
                        <span>Free</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>