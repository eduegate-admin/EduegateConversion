<div class="app-page flex-column flex-column-fluid" ng-controller="AllergiesController">


    <div class="app-content flex-column-fluid">
        <div class="app-header d-flex shodow-sm">
            <div class="app-container container-xxl d-flex align-items-center justify-content-between ios-pt-12"
                id="kt_app_header_container">
                <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0 me-lg-15">
                    <a ui-sref="onlinestore({loadBlocks:false})" ui-sref-opts="{reload: true}">
                        <img alt="Logo" src="./clients/{{$root.ClientSettings.Client}}/images/back-arrow.svg" class="h-25px">
                    </a>
                </div>
                <div class="d-flex align-items-center d-lg-none ms-2" title="Show sidebar menu">
                    <div class="d-flex align-items-center d-lg-none ms-2" >
                        <span class="svg-icon svg-icon-2x position-relative" ui-sref="singlecheckout">
                            <span class="rounded-circle position-absolute bg-dark badge translate-end bottom-100 start-100 h-20px w-20px fs-9 text-grey-800 mb-n3 ms-n3 d-flex flex-center"  ng-bind="ShoppingCartCount" ng-if="ShoppingCartCount > 0">5</span><!-- end ngIf: ShoppingCartCount > 0 -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" fill="currentColor"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"></path></svg>
                            </span>
                </div>
                </div>
            </div>
        </div>
        <div class="app-toolbar py-3 py-lg-0">
            <div class="app-container container-xxl d-flex flex-stack">
                <div class="page-title d-flex flex-column justify-content-center me-3">
                    <h1 class="page-heading d-flex text-dark fw-bold fs-2 flex-column justify-content-center my-0">Student
                        Allergies
                    </h1>
                </div>
                <div class="d-flex align-items-center gap-2 gap-lg-3">

                </div>
            </div>
        </div>
        <div class="app-container container-xxl pt-5">
            <div class="row gy-5 g-xl-10">

                <div class="col-xl-4">
                    <div class="accordion" id="kt_accordion_1">


                        <div class="accordion-item"  ng-repeat="ward in MyWards">
                            <h2 class="accordion-header" id="kt_accordion_1_header_2">
                                <button class="accordion-button fs-4 fw-bold collapsed" type="button"
                                    data-bs-toggle="collapse" data-bs-target="#kt_accordion_1_body_{{$index}}"
                                    aria-expanded="false" aria-controls="kt_accordion_1_body_{{$index}}">

                                    <div
                                        class="d-flex fs-6 fw-bold align-items-center w-100 justify-content-between">

                                        <div class="d-flex flex-column">
                                            <div class="text-gray-700 flex-grow-1 me-4 mb-3">
                                                {{ward.FirstName}} {{ward.MiddleName}} {{ward.LastName}}</div>

                                        </div>


                                    </div>

                                </button>
                            </h2>
                            <div id="kt_accordion_1_body_{{$index}}" class="accordion-collapse collapse"
                                ng-class='{show:$first}' aria-labelledby="kt_accordion_1_header_{{$index}}"
                                data-bs-parent="#kt_accordion_{{$index}}">
                                <div class="accordion-body">
                                    <div class="row g-5">

                                        <div class="col-sm-6" >
                                            <div class="fw-bold fs-7 text-gray-600 mb-1 flex-center">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-seam me-2" viewBox="0 0 576 512"><!-- Font Awesome Pro 6.0.0-alpha2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --><path d="M508.438 220.438H487.562C468.141 220.438 451.469 209.281 444.031 191.344C436.609 173.438 440.516 153.75 454.25 140.031L469.031 125.25C475.75 118.531 479.453 109.625 479.453 100.125S475.75 81.688 469.031 74.969C455.156 61.094 432.625 61.094 418.75 74.969L403.984 89.75C390.266 103.469 370.578 107.344 352.641 99.969C334.703 92.531 323.562 75.844 323.562 56.438V35.562C323.562 15.969 307.609 0 288 0S252.438 15.969 252.438 35.562V56.438C252.438 75.844 241.297 92.531 223.359 99.969C205.391 107.344 185.75 103.469 172.016 89.75L157.25 74.969C143.375 61.094 120.844 61.156 106.969 74.969C100.25 81.688 96.547 90.625 96.547 100.125S100.25 118.531 106.969 125.25L121.75 140.031C135.484 153.75 139.391 173.438 131.969 191.344C124.531 209.281 107.859 220.438 88.437 220.438H67.562C47.953 220.438 32 236.406 32 256S47.953 291.562 67.562 291.562H88.438C107.859 291.562 124.531 302.719 131.969 320.656C139.391 338.562 135.484 358.25 121.75 371.969L106.969 386.75C100.25 393.469 96.547 402.375 96.547 411.875S100.25 430.312 106.969 437.031C120.453 450.469 143.859 450.469 157.25 437.031L172.016 422.25C185.75 408.531 205.391 404.687 223.359 412.031C241.297 419.469 252.438 436.156 252.438 455.562V476.438C252.438 496.031 268.391 512 288 512S323.562 496.031 323.562 476.438V455.562C323.562 436.156 334.703 419.469 352.641 412.031C370.578 404.687 390.266 408.531 403.984 422.25L418.75 437.031C432.141 450.469 455.547 450.469 469.031 437.031C475.75 430.312 479.453 421.375 479.453 411.875S475.75 393.469 469.031 386.75L454.25 371.969C440.516 358.25 436.609 338.562 444.031 320.656C451.469 302.719 468.141 291.562 487.563 291.562H508.438C528.047 291.562 544 275.594 544 256S528.047 220.438 508.438 220.438ZM508.438 275.562H487.562C461.547 275.562 439.203 290.5 429.25 314.531C419.297 338.531 424.547 364.906 442.938 383.281L457.719 398.062C461.422 401.75 463.453 406.656 463.453 411.875S461.406 422.031 457.719 425.719C450.297 433.125 437.422 433.062 430.063 425.719L415.297 410.937C396.875 392.531 370.563 387.375 346.516 397.25C322.484 407.219 307.562 429.562 307.562 455.562V476.437C307.562 487.219 298.781 496 288 496S268.438 487.219 268.438 476.438V455.562C268.438 429.562 253.516 407.219 229.484 397.25C221.422 393.906 213.109 392.281 204.922 392.281C188.688 392.281 172.938 398.719 160.703 410.938L145.938 425.719C138.562 433.063 125.688 433.125 118.281 425.719C114.594 422.031 112.547 417.094 112.547 411.875S114.578 401.75 118.281 398.063L133.063 383.281C151.453 364.906 156.703 338.531 146.75 314.531C136.797 290.5 114.453 275.562 88.438 275.562H67.562C56.781 275.562 48 266.781 48 256S56.781 236.438 67.562 236.438H88.438C114.453 236.438 136.797 221.5 146.75 197.469C156.703 173.469 151.453 147.094 133.062 128.719L118.281 113.938C114.578 110.25 112.547 105.344 112.547 100.125S114.594 89.969 118.281 86.281C125.906 78.656 138.312 78.656 145.937 86.281L160.703 101.062C179.109 119.438 205.422 124.625 229.484 114.75C253.516 104.781 268.438 82.438 268.438 56.438V35.562C268.438 24.781 277.219 16 288 16S307.562 24.781 307.562 35.562V56.438C307.562 82.438 322.484 104.781 346.516 114.75C370.578 124.719 396.906 119.438 415.297 101.062L430.063 86.281C437.703 78.656 450.109 78.656 457.719 86.281C461.406 89.969 463.453 94.906 463.453 100.125S461.422 110.25 457.719 113.937L442.938 128.719C424.547 147.094 419.297 173.469 429.25 197.469C439.203 221.5 461.547 236.437 487.562 236.437H508.438C519.219 236.438 528 245.219 528 256S519.219 275.562 508.438 275.562ZM256 168C225.125 168 200 193.125 200 224S225.125 280 256 280S312 254.875 312 224S286.875 168 256 168ZM256 264C233.938 264 216 246.062 216 224S233.938 184 256 184S296 201.938 296 224S278.062 264 256 264ZM336 288C327.164 288 320 295.162 320 304C320 312.836 327.164 320 336 320S352 312.836 352 304C352 295.162 344.836 288 336 288Z"/></svg>
                                                Allergies</div>

                                                <div class="my-2">
                                                    <div class="badge badge-secondary fs-base me-3 ">{{ward.Allergy.AllergyName}}</div>
                                                </div>
                                            <div class="fw-bold fs-6 text-gray-800 ng-binding ms-9"></div>
                                            <form name="myForm">
                                                    <!-- <select  name="Allergies"
                                                    ng-model="Allergies"
                                                    ng-options="allergy.key as allergy.Value for allergy in Allergies"  class="form-select  form-select-lg form-select-solid js-example-basic-single allergies" data-control="select2" data-close-on-select="false" data-hide-search="false" data-placeholder="Select an option" data-allow-clear="true" multiple="multiple">
                                                        <optgroup label="Allergens">


                                                        </optgroup>
                                                    </select> -->
                                                 <label for="multipleSelect{{ward.StudentIID}}">  Select allergy: </label><br>
                                                    <select name="multipleSelect" id="multipleSelect{{ward.StudentIID}}" ng-model="multipleSelect"  style="display: block;" class=" my-2  js-example-basic-single allergies"

                                                    ng-options="allergy as allergy.Value for allergy in Allergies" >

                                                    <button type="button" class="btn btn-sm btn-primary" ng-click="SaveAllergies($event, ward.StudentIID , multipleSelect)">
                                                        Save
                                                    </button>
                                                </form>
                                                <!-- <script type="text/javascript">

                                                        function formatState(state) {
                                                            if (!state.id) {
                                                                return state.text;
                                                            }
                                                            var baseUrl = "./clients/pearl/images/allergies";
                                                            var $state = $(
                                                                '<span><img src="' + baseUrl + '/' + state.text.toLowerCase() + '.svg"   class="img-flag h-20px me-2" /> ' + state.text + '</span>'
                                                            );
                                                            console.log(state.text)
                                                            return $state;
                                                        };
                                                        function formatStateSelected(state) {
                                                            if (!state.id) {
                                                                return state.text;
                                                            }

                                                            var baseUrl = "./clients/pearl/images/allergies";
                                                            var $state = $(
                                                                '<span><img class="img-flag h-20px mx-2" /> <span></span></span>'
                                                            );

                                                            // Use .text() instead of HTML string concatenation to avoid script injection issues
                                                            $state.find("span").text(state.text);
                                                            $state.find("img").attr("src", baseUrl + "/" + state.text.toLowerCase() + ".svg").on("error", function() {
                                                                this.onerror = null;
                                                                this.src = "./clients/pearl/images/allergies/empty-set.svg";
                                                            });

                                                            return $state;
                                                        };

                                                        $(document).ready(function () {
                                                            $(".js-example-basic-single").select2(
                                                                {
                                                                    templateResult: formatState,
                                                                    templateSelection: formatStateSelected
                                                                }
                                                            );
                                                        });

                                                </script> -->



<!--end::Row-->

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



            </div>
        </div>
    </div>